@using ForumAgent.ReadModels
@model IList<ForumContent>

<script type="text/javascript" src="@Url.Content("~/Content/jquery.timers-1.2.js")"></script>
<script type="text/javascript">
	$(document).ready(function() {
		$("#add-content").click(function() {
			$("<div></div>")
				.load("@Url.Action("NewContent", "Content", new { forumId = ViewContext.RouteData.Values["forumId"] })")
				.modal({
						autoResize: true,
						autoPosition: true,
						position: new Array(25, 300),
						dataCss: { backgroundColor: "#fff", overflow: "hidden", height: 585, width: 525 },
						containerCss: { height: 600, width: 540 }
					});

			return false;
		});
		
		$(".edit").click(function() {
			var contentId = $(this).attr("data-item-id");
			$("<div></div>")
				.load("@Url.Action("UpdateContent", "Content")?contentId=" + contentId)
				.modal({
						autoResize: true,
						autoPosition: true,
						position: new Array(25, 300),
						dataCss: { backgroundColor: "#fff", overflow: "hidden", height: 585, width: 525 },
						containerCss: { height: 600, width: 540 }
					});

			return false;
		});

		$(".preview").click(function() {
			var contentId = $(this).attr("data-item-id");
			$("<div></div>")
				.load("@Url.Action("Preview")?contentId=" + contentId)
				.modal({
						autoResize: true,
						autoPosition: true,
						position: new Array(25, 300),
						dataCss: { backgroundColor: "#fff", overflow: "hidden", height: 585, width: 525 },
						containerCss: { height: 600, width: 540 }
					});

			return false;
		});
	});

	function deleteContent(contentId) {
		$.ajax({
				url: "@Url.Action("Delete")",
				data: { contentId: contentId },
				success: function() { window.location.reload(); }
			});

		return false;
	}
</script>

<article>
	<header>
		<h2>Content for Forum</h2>
	</header>
</article>

<section>
	<table>
		<thead>
			<tr>
				<th>Location</th>
				<th>Type</th>
				<th>Active</th>
				<th>&nbsp;</th>
			</tr>
		</thead>
		<tbody>
			@foreach (var content in Model)
			{
				<tr>
					<td>@content.ContentLocation</td>
					<td>@content.ContentType</td>
					<td>@if (content.Active) {<text>Yes</text>}else{<text>No</text>}</td>
					<td>
					<ul class="actions">
						<li><a class="edit" rel="tooltip" href="#" original-title="Edit" data-item-id="@content.Identifier">Edit</a></li>
						<li><a class="admin-delete confirmation-dialog" href="#" rel="tooltip" original-title="Delete" data-confirmation-message="Do you want to delete this content?" data-confirm-function="deleteContent" data-item-id="@content.Identifier">Delete</a></li>
						<li><a class="preview" data-item-id="@content.Identifier" href="#" rel="tooltip" original-title="Preview">Delete</a></li>
					</ul>
				</td>
				</tr>
			}
		</tbody>
	</table>

	<button type="submit" id="add-content">Add Content</button>
</section>

@section Breadcrumbs{
	<ul id="breadcrumbs">
		<li>@Html.ActionLink("Home", "Index", "Dashboard")</li>
		<li>Custom Content</li>
	</ul>
}